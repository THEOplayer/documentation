"use strict";(self.webpackChunkdocumentation=self.webpackChunkdocumentation||[]).push([["73685"],{76068:function(e,n,i){i.r(n),i.d(n,{default:()=>h,frontMatter:()=>a,metadata:()=>t,assets:()=>d,toc:()=>l,contentTitle:()=>o});var t=JSON.parse('{"id":"getting-started/getting-started-signaling-service","title":"Signaling service","description":"The Signaling Service is provided as a service and can be integrated into any existing content management workflow through its APIs, enabling seamless adoption without significant changes to your current setup.","source":"@site/theoads/getting-started/00-getting-started-signaling-service.mdx","sourceDirName":"getting-started","slug":"/getting-started/getting-started-signaling-service","permalink":"/documentation/pr-preview/pr-248/theoads/getting-started/getting-started-signaling-service","draft":false,"unlisted":false,"editUrl":"https://github.com/THEOplayer/documentation/blob/-/theoads/getting-started/00-getting-started-signaling-service.mdx","tags":[],"version":"current","sidebarPosition":0.1,"frontMatter":{"sidebar_position":0.1,"sidebar_label":"Signaling service","sidebar_custom_props":{"icon":"\uD83D\uDEDC"}},"sidebar":"theoads","previous":{"title":"Getting started","permalink":"/documentation/pr-preview/pr-248/theoads/getting-started/"},"next":{"title":"Web","permalink":"/documentation/pr-preview/pr-248/theoads/getting-started/getting-started-web"}}'),s=i("85893"),r=i("50065");let a={sidebar_position:.1,sidebar_label:"Signaling service",sidebar_custom_props:{icon:"\uD83D\uDEDC"}},o="Signaling service",d={},l=[{value:"Infrastructure integration",id:"infrastructure-integration",level:2},{value:"Monetized streams",id:"monetized-streams",level:2},{value:"Creating a new monetized stream",id:"creating-a-new-monetized-stream",level:3},{value:"Updating an existing monetized stream",id:"updating-an-existing-monetized-stream",level:3},{value:"Deleting an existing monetized stream",id:"deleting-an-existing-monetized-stream",level:3},{value:"Retrieving all monetized streams",id:"retrieving-all-monetized-streams",level:3},{value:"Retrieving an individual monetized stream",id:"retrieving-an-individual-monetized-stream",level:3},{value:"Player source",id:"player-source",level:3},{value:"Scheduling ad breaks",id:"scheduling-ad-breaks",level:2},{value:"Manifest",id:"manifest",level:3},{value:"REST API",id:"rest-api",level:3}];function c(e){let n={a:"a",blockquote:"blockquote",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",img:"img",li:"li",p:"p",pre:"pre",ul:"ul",...(0,r.a)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n.header,{children:(0,s.jsx)(n.h1,{id:"signaling-service",children:"Signaling service"})}),"\n",(0,s.jsx)(n.p,{children:"The Signaling Service is provided as a service and can be integrated into any existing content management workflow through its APIs, enabling seamless adoption without significant changes to your current setup."}),"\n",(0,s.jsx)(n.p,{children:"Developed and provided by THEO Technologies, this service operates on your infrastructure, integrated between your CDN and media origin. It performs manifest manipulation to insert ad breaks and additional metadata for the player. Additionally, it ensures scalability of the end-to-end system through early ad break notifications to ad decisioning servers."}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.img,{alt:"THEOads architecture",src:i(59089).Z+"",width:"962",height:"529"})}),"\n",(0,s.jsx)(n.h2,{id:"infrastructure-integration",children:"Infrastructure integration"}),"\n",(0,s.jsx)(n.p,{children:"The service is deployed and operated by THEO Technologies within the customer\u2019s infrastructure. This setup ensures smooth integration into the existing video workflow with minimal disruption. During onboarding, THEO Technologies provides the specific infrastructure and network requirements. Once set up, THEO Technologies bootstraps the service, after which the customer can manage their streams and monitor the service through the REST API."}),"\n",(0,s.jsx)(n.p,{children:"In collaboration with the customer and THEO's solutions team, the integration of the service into the existing video workflow is designed. Deploying the Signaling Service between the CDN and Origin ensures that regionalization, security, and localization features remain unaffected."}),"\n",(0,s.jsxs)(n.blockquote,{children:["\n",(0,s.jsx)(n.p,{children:"To ensure high availability, we recommend maintaining the original origin stream on a CDN as a backup, while the Signaling Service provides redundancy and failover capabilities to further enhance reliability."}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"monetized-streams",children:"Monetized streams"}),"\n",(0,s.jsx)(n.p,{children:"After deployment of the Signaling Service has been completed, the next step is the creation of monetized streams. A monetized stream represents an instance of a origin stream that is processed by the Signaling Service to enable THEOads for this origin stream. Created via the locally deployed REST API, it exposes a standardized HTTPS (or HTTP) endpoint for the CDN to fetch the augmented manifest. This setup ensures seamless ad insertion without needing CDN reconfiguration, even if the monetized stream is stopped and recreated."}),"\n",(0,s.jsx)(n.p,{children:"The monetized stream holds the following information:"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"streamId"}),": Unique identifier for the monetized stream within the environment."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"name"}),": Self defined descriptive name for the monetized stream."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"description"}),": Optional descriptive information for the monetized stream."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"labels"}),": Array of self defined labels (string)."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"layout"}),": Default experience layout, see ",(0,s.jsx)(n.a,{href:"/theoads/how-to-guides/override-layout/",children:"ad experience layout"}),"."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"origin"}),": Your media origin host."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"segmentOrigin"}),": Your publicly available segments origin host."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"assetKey"}),": Google DAI Asset-Key linked to this stream, see ",(0,s.jsx)(n.a,{href:"https://support.google.com/admanager/topic/7062524?hl=en",children:"Google DAI"}),"."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"networkCode"}),": Google DAI Network-Code, see ",(0,s.jsx)(n.a,{href:"https://support.google.com/admanager/topic/7062524?hl=en",children:"Google DAI"}),"."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"assetURI"}),": Optional custom asset URI which is to be used during ad breaks. If not set it will request an adbreak through Google Pod Serving."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"backdropURI"}),": Optional URI containing the back-drop to be used during the double box or L-shape ad."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"streamType"}),": Optional property to specify this stream's type to be either 'LIVE' (the default) or 'VOD'. Note: this is only relevant for scheduling overlays for now."]}),"\n"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-json",children:'{\n  "streamId": "theoads-demo",\n  "name": "THEOads Demo",\n  "description": "SGAI THEOads Demo",\n  "labels": [],\n  "layout": "DOUBLE",\n  "origin": "https://domain.com",\n  "segmentOrigin": "https://segment-domain.com",\n  "assetKey": "google-sgai-demo",\n  "networkCode": "89053",\n  "assetURI": "https://asset.m3u8",\n  "backdropURI": "https://backdrop.svg"\n}\n'})}),"\n",(0,s.jsx)(n.h3,{id:"creating-a-new-monetized-stream",children:"Creating a new monetized stream"}),"\n",(0,s.jsx)(n.p,{children:"The following API endpoint creates a new monetized stream, mandatory parameters are:"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"streamId"}),": Unique identifier for the monetized stream within the environment."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"name"}),": Self defined descriptive name for the monetized stream."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"description"}),": Optional descriptive information for the monetized stream."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"layout"}),": Default experience layout, see ",(0,s.jsx)(n.a,{href:"/theoads/how-to-guides/override-layout/",children:"ad experience layout"}),"."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"origin"}),": Your media Origin host."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"segmentOrigin"}),": Your publicly available segments origin."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"assetKey"}),": Google DAI Asset-Key representing the stream, see ",(0,s.jsx)(n.a,{href:"https://support.google.com/admanager/topic/7062524?hl=en",children:"Google DAI"}),"."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"networkCode"}),": Google DAI Network-Code, see ",(0,s.jsx)(n.a,{href:"https://support.google.com/admanager/topic/7062524?hl=en",children:"Google DAI"}),"."]}),"\n"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-curl",children:'curl -L \'https://<theoads-host>/ads-client/api/v1/monetized-streams\' \\\n-H \'Content-Type: application/json\' \\\n-H \'Accept: application/json\' \\\n-d \'{\n  "streamId": "string",\n  "name": "string",\n  "description": "string",\n  "layout": "SINGLE",\n  "origin": "string",\n  "segmentOrigin": "string",\n  "assetKey": "string",\n  "networkCode": "string"\n}\'\n'})}),"\n",(0,s.jsx)(n.h3,{id:"updating-an-existing-monetized-stream",children:"Updating an existing monetized stream"}),"\n",(0,s.jsx)(n.p,{children:"The following API endpoint updates an existing monetized stream based on it's streamId, mandatory parameters are:"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"streamId"}),": Unique identifier for the monetized stream within the environment."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"name"}),": Self defined descriptive name for the monetized stream."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"description"}),": Additional descriptive information for the monetized stream."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"labels"}),": Array of self defined labels (string)."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"layout"}),": Default experience layout, see ",(0,s.jsx)(n.a,{href:"/theoads/how-to-guides/override-layout/",children:"ad experience layout"}),"."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"origin"}),": Your media Origin host."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"segmentOrigin"}),": Your publicly available segments origin."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"assetKey"}),": Google DAI Asset-Key representing the stream, see ",(0,s.jsx)(n.a,{href:"https://support.google.com/admanager/topic/7062524?hl=en",children:"Google DAI"}),"."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"networkCode"}),": Google DAI Network-Code, see ",(0,s.jsx)(n.a,{href:"https://support.google.com/admanager/topic/7062524?hl=en",children:"Google DAI"}),"."]}),"\n"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-curl",children:'curl -L -X PATCH \'https://<theoads-host>/ads-client/api/v1/monetized-streams/:streamId\' \\\n-H \'Content-Type: application/json\' \\\n-H \'Accept: application/json\' \\\n-d \'{\n  "streamId": "string",\n  "name": "string",\n  "description": "string",\n  "labels": [\n    "string"\n  ],\n  "origin": "string",\n  "segmentOrigin": "string",\n  "assetKey": "string",\n  "networkCode": "string"\n}\'\n'})}),"\n",(0,s.jsx)(n.h3,{id:"deleting-an-existing-monetized-stream",children:"Deleting an existing monetized stream"}),"\n",(0,s.jsx)(n.p,{children:"The following API endpoint deletes an existing monetized stream based on it's streamId."}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-curl",children:"curl -L -X DELETE 'https://<theoads-host>/ads-client/api/v1/monetized-streams/:streamId' \\\n-H 'Accept: application/json'\n"})}),"\n",(0,s.jsx)(n.h3,{id:"retrieving-all-monetized-streams",children:"Retrieving all monetized streams"}),"\n",(0,s.jsx)(n.p,{children:"The following API endpoint returns all existing monetized streams in the deployed environment."}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-curl",children:"curl -X 'GET' \\\n  'https://<theoads-host>/ads-client/api/v1/monetized-streams' \\\n  -H 'accept: application/json'\n"})}),"\n",(0,s.jsx)(n.p,{children:"The response is an array of the existing monetized stream resources."}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-json",children:'[\n  {\n    "id": "theoads-demo",\n    "payload": {\n      "streamId": "theoads-demo",\n      "name": "THEOads Demo",\n      "description": "SGAI THEOads Demo",\n      "labels": [],\n      "layout": "DOUBLE",\n      "origin": "https://domain.com",\n      "segmentOrigin": "https://segment-domain.com",\n      "assetKey": "google-sgai-demo",\n      "networkCode": "89053"\n    },\n    "state": "created",\n    "type": "monetized-stream"\n  }\n]\n'})}),"\n",(0,s.jsx)(n.h3,{id:"retrieving-an-individual-monetized-stream",children:"Retrieving an individual monetized stream"}),"\n",(0,s.jsx)(n.p,{children:"The following API endpoint returns an existing monetized stream based on its identifier (streamId)."}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-curl",children:"curl -L 'https://<theoads-host>/ads-client/api/v1/monetized-streams/:streamId' \\\n-H 'Accept: application/json'\n"})}),"\n",(0,s.jsx)(n.p,{children:"The response is the monetized stream resource."}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-json",children:'{\n  "id": "theoads-demo",\n  "payload": {\n    "streamId": "theoads-demo",\n    "name": "THEOads Demo",\n    "description": "SGAI THEOads Demo",\n    "labels": [],\n    "layout": "DOUBLE",\n    "origin": "https://domain.com",\n    "segmentOrigin": "https://segment-domain.com",\n    "assetKey": "google-sgai-demo",\n    "networkCode": "89053"\n  },\n  "state": "created",\n  "type": "monetized-stream"\n}\n'})}),"\n",(0,s.jsxs)(n.p,{children:["Please refer to the ",(0,s.jsx)(n.a,{href:"/theoads/api/signaling/theoads-api/",children:"API reference"})," for even more detailed information on the REST API."]}),"\n",(0,s.jsx)(n.h3,{id:"player-source",children:"Player source"}),"\n",(0,s.jsx)(n.p,{children:"When playing a THEOads source corresponding to a monetized stream, it is expected to pass a source that looks like this:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-js",children:"src: 'https://<theoads-host>/signaling-service/api/v1/<monetized-stream-id>/hls/MANIFEST-URI';\n"})}),"\n",(0,s.jsxs)(n.p,{children:["In this URI, the ",(0,s.jsx)(n.code,{children:"<theoads-host>"})," points to the network endpoint where the THEOads service is deployed, preferably a DNS entry pointing to the service IP endpoint and reachable from the CDN.\nSecondly, the ",(0,s.jsx)(n.code,{children:"<monetized-stream-id>"})," corresponds to the ",(0,s.jsx)(n.code,{children:"streamId"})," for the monetized stream.\nFinally, the ",(0,s.jsx)(n.code,{children:"MANIFEST-URI"})," part points to the origin's manifest relative to the configured ",(0,s.jsx)(n.code,{children:"origin"})," property of the monetized stream.\nFor example:"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-js",children:"src: 'https://<theoads-host>/signaling-service/api/v1/<monetized-stream-id>/hls/manifest.m3u8';\n"})}),"\n",(0,s.jsxs)(n.p,{children:["Segment URLs in the media playlists should be absolute URLs however.\nSegment requests don't need to pass through the Signaling Service but should be fetched directly from the CDN to the origin so as to keep the benefit of scaling via the CDN.\nThe ",(0,s.jsx)(n.code,{children:"segmentOrigin"})," parameter should contain this publicly available endpoint to fetch the segments directly."]}),"\n",(0,s.jsx)(n.h2,{id:"scheduling-ad-breaks",children:"Scheduling ad breaks"}),"\n",(0,s.jsxs)(n.p,{children:["Once all the required monetized streams are configured, the next step is scheduling ad breaks for these monetized streams.\nTo accurately schedule breaks, the origin manifest must be valid and include date and time indications.\nFor HLS, this means the ",(0,s.jsx)(n.code,{children:"EXT-X-PROGRAM-DATE-TIME"})," tag must be present.\nAd breaks can be signaled through either the provided REST API or by including the relevant information in the manifest itself."]}),"\n",(0,s.jsx)(n.h3,{id:"manifest",children:"Manifest"}),"\n",(0,s.jsx)(n.p,{children:"When using manifest signaling, the following tags are supported:"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"#EXT-X-DATERANGE"})," tag","\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"this is recommended because of its standardization and ability to provide more comprehensive data for improved integration."}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"#EXT-X-OATCLS-SCTE35"})," tag"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"#EXT-X-CUE-OUT"})," and ",(0,s.jsx)(n.code,{children:"#EXT-X-CUE-OUT-CONT"})," tags"]}),"\n",(0,s.jsxs)(n.li,{children:["To use the tune-in feature, ",(0,s.jsx)(n.code,{children:"#EXT-X-CUE-OUT-CONT"})," tags must be present between ",(0,s.jsx)(n.code,{children:"#EXT-X-CUE-OUT"})," and ",(0,s.jsx)(n.code,{children:"#EXT-X-CUE-IN"})," markers."]}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:"Optionally, SCTE markers can be included with the tags for extra metadata."}),"\n",(0,s.jsx)(n.h3,{id:"rest-api",children:"REST API"}),"\n",(0,s.jsxs)(n.p,{children:["For scheduling ad breaks through the REST API, please refer to the ",(0,s.jsx)(n.a,{href:"/theoads/api/signaling/create-monetized-stream-break/",children:"API definitions"})," and the example below."]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:'curl --location \'https://<theoads-host>/ads-client/api/v1/monetized-streams/stream-1/break\' \\\n--header \'Content-Type: application/json\' \\\n--header \'Accept: application/json\' \\\n--data \'{\n  "id": "626cd35a-4fbf-48b8-b0cd-acc246266f88",\n  "startDate": "2024-09-03T08:00:00.000Z",\n  "duration": 60,\n  "source": "",\n  "layout": "LSHAPE_AD"\n}\'\n'})}),"\n",(0,s.jsxs)(n.p,{children:["For more in depth information on scheduling ad breaks we refer to our ",(0,s.jsx)(n.a,{href:"/theoads/how-to-guides/scheduling-breaks/",children:"How-to guide: Scheduling breaks"})]}),"\n",(0,s.jsxs)(n.p,{children:["For more information on this topic we refer to our ",(0,s.jsx)(n.a,{href:"/theoads/how-to-guides/workflow-integration/",children:"workflow integration"}),"."]}),"\n",(0,s.jsx)(n.h1,{id:"more-information",children:"More information"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"/theoads/api/signaling/theoads-api/",children:"API reference"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"https://www.theoplayer.com/product/theoads/",children:"What is THEOads?"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"https://www.theoplayer.com/solutions/server-guided-ad-insertion-sgai/",children:"The Advantages of Server-Guided Ad Insertion"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"https://www.theoplayer.com/product/theoads/pricing/",children:"Flexible, Usage-Based Pricing"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"https://www.theoplayer.com/blog/server-guided-ad-insertion-sgai-revolutionizing-streaming-monetization/",children:"Is Server-Guided Ad-Insertion (SGAI) revolutionizing streaming monetization? (blog)"})}),"\n"]})]})}function h(e={}){let{wrapper:n}={...(0,r.a)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(c,{...e})}):c(e)}},59089:function(e,n,i){i.d(n,{Z:function(){return t}});let t=i.p+"assets/images/how_theoads_works-light-3d0285c578b09f00ee495d3f391c5ae0.svg"},50065:function(e,n,i){i.d(n,{Z:function(){return o},a:function(){return a}});var t=i(67294);let s={},r=t.createContext(s);function a(e){let n=t.useContext(r);return t.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function o(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:a(e.components),t.createElement(r.Provider,{value:n},e.children)}}}]);