"use strict";(self.webpackChunkdocumentation=self.webpackChunkdocumentation||[]).push([["18168"],{228659(e,t,n){n.r(t),n.d(t,{assets:()=>a,contentTitle:()=>o,default:()=>h,frontMatter:()=>s,metadata:()=>i,toc:()=>c});var i=n(853748),r=n(474848),d=n(28453);let s={slug:"/getting-started/frameworks/react-native/background"},o="Background Playback and Notifications",a={},c=[{value:"Overview",id:"overview",level:2},{value:"Configuration",id:"configuration",level:2},{value:"Android",id:"android",level:3},{value:"Notifications, Metadata and Lockscreen Controls",id:"notifications-metadata-and-lockscreen-controls",level:2},{value:"Configuration",id:"configuration-1",level:3}];function l(e){let t={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",img:"img",p:"p",pre:"pre",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",...(0,d.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(t.header,{children:(0,r.jsx)(t.h1,{id:"background-playback-and-notifications",children:"Background Playback and Notifications"})}),"\n",(0,r.jsx)(t.h2,{id:"overview",children:"Overview"}),"\n",(0,r.jsxs)(t.p,{children:["One of the key features of ",(0,r.jsx)(t.code,{children:"react-native-theoplayer"})," is its support for background playback,\nnotifications, and lock-screen controls. This feature allows your users to continue listening\nto audio when the app is not in the foreground, and control playback using notifications and lock-screen controls."]}),"\n",(0,r.jsx)(t.h2,{id:"configuration",children:"Configuration"}),"\n",(0,r.jsxs)(t.p,{children:["The ",(0,r.jsx)(t.code,{children:"backgroundAudioConfiguration"})," player configuration affects the play-out behaviour when the app is moved to\nthe background: in case the ",(0,r.jsx)(t.code,{children:"enabled"})," property is set to ",(0,r.jsx)(t.code,{children:"true"}),", the current media asset will continue\nplaying when the app is moved to the background, otherwise play-out will pause."]}),"\n",(0,r.jsx)(t.p,{children:"The configuration can be modified at run-time, allowing the player to pause depending on the current media asset's\nproperties, or whether an ad is playing or not."}),"\n",(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{className:"language-typescript",children:"player.backgroundAudioConfiguration = { enabled: true };\n"})}),"\n",(0,r.jsxs)(t.p,{children:["Other properties of the ",(0,r.jsx)(t.code,{children:"backgroundAudioConfiguration"})," can be used to further customize the background playback:"]}),"\n",(0,r.jsxs)(t.table,{children:[(0,r.jsx)(t.thead,{children:(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.th,{children:"Field"}),(0,r.jsx)(t.th,{children:"Platform"}),(0,r.jsx)(t.th,{children:"Purpose"}),(0,r.jsx)(t.th,{children:"Default"})]})}),(0,r.jsxs)(t.tbody,{children:[(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.td,{children:(0,r.jsx)(t.code,{children:"enabled"})}),(0,r.jsx)(t.td,{children:"Web, iOS & Android"}),(0,r.jsx)(t.td,{children:"If enabled, playback continues when transitioning to background."}),(0,r.jsx)(t.td,{children:(0,r.jsx)(t.code,{children:"false"})})]}),(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.td,{children:(0,r.jsx)(t.code,{children:"stopOnBackground"})}),(0,r.jsx)(t.td,{children:"Web, iOS & Android"}),(0,r.jsx)(t.td,{children:"If enabled, fully stop playback when the app goes to the background. The player will need to be provided with a new source when the app comes back to the foreground."}),(0,r.jsx)(t.td,{children:(0,r.jsx)(t.code,{children:"false"})})]}),(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.td,{children:(0,r.jsx)(t.code,{children:"shouldResumeAfterInterruption"})}),(0,r.jsx)(t.td,{children:"iOS"}),(0,r.jsx)(t.td,{children:"Controls whether playback should automatically resume after an interruption, such as an incoming phone call."}),(0,r.jsx)(t.td,{children:(0,r.jsx)(t.code,{children:"false"})})]}),(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.td,{children:(0,r.jsx)(t.code,{children:"audioSessionMode"})}),(0,r.jsx)(t.td,{children:"iOS"}),(0,r.jsxs)(t.td,{children:["Specifies the ",(0,r.jsx)(t.a,{href:"https://developer.apple.com/documentation/avfaudio/avaudiosession/mode",children:"AVAudioSession.Mode"})]}),(0,r.jsx)(t.td,{children:(0,r.jsx)(t.code,{children:"AudioSessionMode.MOVIE_PLAYBACK"})})]})]})]}),"\n",(0,r.jsxs)(t.p,{children:["A use case for enabling ",(0,r.jsx)(t.code,{children:"stopOnBackground"})," could be a live stream that should not be allowed to continue in the\nbackground, neither in paused nor playing state. The app should be designed to reload the source or the player page when coming back\nto the foreground."]}),"\n",(0,r.jsx)(t.h3,{id:"android",children:"Android"}),"\n",(0,r.jsxs)(t.p,{children:["On Android, a ",(0,r.jsx)(t.a,{href:"https://developer.android.com/guide/components/services",children:"service"})," is used to\ncontinue playback in the background while the user is not interacting with the app."]}),"\n",(0,r.jsxs)(t.p,{children:["It is possible to disable the service at build time by setting the build config field\n",(0,r.jsx)(t.code,{children:"'THEOplayer_usePlaybackService = false'"}),".\nIn that case the background playback feature is always disabled, no notifications are displayed, and the\nplayer will always pause when the hosting app goes to the background."]}),"\n",(0,r.jsx)(t.h2,{id:"notifications-metadata-and-lockscreen-controls",children:"Notifications, Metadata and Lockscreen Controls"}),"\n",(0,r.jsx)(t.p,{children:"During play-out of a media asset, a notification is displayed that provides some metadata and\nenables basic control. The source description passed to the player should provide the necessary metadata\nproperties:"}),"\n",(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{className:"language-typescript",children:"const source = {\n  // ...\n  poster: 'https://cdn.theoplayer.com/video/big_buck_bunny/poster.jpg',\n  metadata: {\n    title: 'My stream title',\n    subtitle: 'A subtitle or artist',\n    nowPlayingServiceIdentifier: 'serviceId',\n    nowPlayingContentIdentifier: 'contentId',\n    displayIconUri: 'https://cdn.theoplayer.com/video/big_buck_bunny/poster.jpg',\n  }\n}\n"})}),"\n",(0,r.jsx)(t.p,{children:"The following fields from the source description are used to display information in the lockscreen:"}),"\n",(0,r.jsxs)(t.table,{children:[(0,r.jsx)(t.thead,{children:(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.th,{children:"Field"}),(0,r.jsx)(t.th,{children:"Purpose"})]})}),(0,r.jsxs)(t.tbody,{children:[(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.td,{children:(0,r.jsx)(t.code,{children:"source.metadata.title"})}),(0,r.jsx)(t.td,{children:"Lockscreen title"})]}),(0,r.jsxs)(t.tr,{children:[(0,r.jsxs)(t.td,{children:[(0,r.jsx)(t.code,{children:"source.metadata.artist"})," with fallback to ",(0,r.jsx)(t.code,{children:"source.metadata.subtitle"})]}),(0,r.jsx)(t.td,{children:"Lockscreen artist"})]}),(0,r.jsxs)(t.tr,{children:[(0,r.jsxs)(t.td,{children:[(0,r.jsx)(t.code,{children:"source.metadata.displayIconUri"})," with fallback to ",(0,r.jsx)(t.code,{children:"source.poster"})]}),(0,r.jsx)(t.td,{children:"Lockscreen image"})]})]})]}),"\n",(0,r.jsx)(t.p,{children:"The following fields allow additional configuration for the lockscreen behaviour on iOS:"}),"\n",(0,r.jsxs)(t.table,{children:[(0,r.jsx)(t.thead,{children:(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.th,{children:"Field"}),(0,r.jsx)(t.th,{children:"Purpose"})]})}),(0,r.jsxs)(t.tbody,{children:[(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.td,{children:(0,r.jsx)(t.code,{children:"source.metadata.nowPlayingServiceIdentifier"})}),(0,r.jsx)(t.td,{children:"Info property service identifier"})]}),(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.td,{children:(0,r.jsx)(t.code,{children:"source.metadata.nowPlayingContentIdentifier"})}),(0,r.jsx)(t.td,{children:"Info property content identifier"})]})]})]}),"\n",(0,r.jsxs)(t.table,{children:[(0,r.jsx)(t.thead,{children:(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.th,{children:(0,r.jsx)(t.img,{alt:"notification_android",src:n(75686).A+"",width:"800",height:"403"})}),(0,r.jsx)(t.th,{style:{textAlign:"center"},children:(0,r.jsx)(t.img,{alt:"notification_ios",src:n(410988).A+"",width:"797",height:"340"})}),(0,r.jsx)(t.th,{style:{textAlign:"center"},children:(0,r.jsx)(t.img,{alt:"notification_web",src:n(375449).A+"",width:"791",height:"364"})})]})}),(0,r.jsx)(t.tbody,{children:(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.td,{children:"Android"}),(0,r.jsx)(t.td,{style:{textAlign:"center"},children:"iOS"}),(0,r.jsx)(t.td,{style:{textAlign:"center"},children:"Web"})]})})]}),"\n",(0,r.jsx)(t.h3,{id:"configuration-1",children:"Configuration"}),"\n",(0,r.jsxs)(t.p,{children:["The ",(0,r.jsx)(t.code,{children:"mediaControl"})," property of ",(0,r.jsx)(t.code,{children:"PlayerConfiguration"})," hosts properties that affect the notifications, media sessions and\ncontrols on each platform. The following table describes the available configuration options:"]}),"\n",(0,r.jsxs)(t.table,{children:[(0,r.jsx)(t.thead,{children:(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.th,{children:"Field"}),(0,r.jsx)(t.th,{children:"Platform"}),(0,r.jsx)(t.th,{children:"Purpose"}),(0,r.jsx)(t.th,{children:"Default"})]})}),(0,r.jsxs)(t.tbody,{children:[(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.td,{children:(0,r.jsx)(t.code,{children:"mediaSessionEnabled"})}),(0,r.jsx)(t.td,{children:"Web & Android"}),(0,r.jsx)(t.td,{children:"If disabled, no media session properties or actions will be set."}),(0,r.jsx)(t.td,{children:(0,r.jsx)(t.code,{children:"true"})})]}),(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.td,{children:(0,r.jsx)(t.code,{children:"skipForwardInterval"})}),(0,r.jsx)(t.td,{children:"Web, iOS & Android"}),(0,r.jsx)(t.td,{children:"If disabled, no media session properties or actions will be set."}),(0,r.jsxs)(t.td,{children:[(0,r.jsx)(t.code,{children:"5"})," (Web & Android), ",(0,r.jsx)(t.code,{children:"15"})," (iOS)"]})]}),(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.td,{children:(0,r.jsx)(t.code,{children:"skipBackwardInterval"})}),(0,r.jsx)(t.td,{children:"Web, iOS & Android"}),(0,r.jsx)(t.td,{children:"If disabled, no media session properties or actions will be set."}),(0,r.jsxs)(t.td,{children:[(0,r.jsx)(t.code,{children:"5"})," (Web & Android), ",(0,r.jsx)(t.code,{children:"15"})," (iOS)"]})]}),(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.td,{children:(0,r.jsx)(t.code,{children:"convertSkipToSeek"})}),(0,r.jsx)(t.td,{children:"iOS & Android"}),(0,r.jsx)(t.td,{children:"A flag that allows next/previous track commands to be interpreted as skip forward/backward commands, according to the configured skip intervals."}),(0,r.jsx)(t.td,{children:(0,r.jsx)(t.code,{children:"false"})})]}),(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.td,{children:(0,r.jsx)(t.code,{children:"allowLivePlayPause"})}),(0,r.jsx)(t.td,{children:"iOS & Android"}),(0,r.jsx)(t.td,{children:"A flag that indicates whether play/pause controls for live streams are enabled."}),(0,r.jsxs)(t.td,{children:[(0,r.jsx)(t.code,{children:"true"})," (iOS), ",(0,r.jsx)(t.code,{children:"false"})," (Android)"]})]}),(0,r.jsxs)(t.tr,{children:[(0,r.jsx)(t.td,{children:(0,r.jsx)(t.code,{children:"seekToLiveOnResume"})}),(0,r.jsx)(t.td,{children:"iOS & Android"}),(0,r.jsxs)(t.td,{children:["A flag that controls whether to seek to the live edge when resuming a paused live stream. Note that ",(0,r.jsx)(t.code,{children:"allowLivePlayPause"})," needs to be enabled for this property to have effect."]}),(0,r.jsx)(t.td,{children:(0,r.jsx)(t.code,{children:"false"})})]})]})]})]})}function h(e={}){let{wrapper:t}={...(0,d.R)(),...e.components};return t?(0,r.jsx)(t,{...e,children:(0,r.jsx)(l,{...e})}):l(e)}},75686(e,t,n){n.d(t,{A:()=>i});let i=n.p+"assets/images/notification_android-d782297b7b92dc30e196b0000efdd7a7.png"},410988(e,t,n){n.d(t,{A:()=>i});let i=n.p+"assets/images/notification_ios-3ac8d1563482c7b4728aa098f9034dbc.png"},375449(e,t,n){n.d(t,{A:()=>i});let i=n.p+"assets/images/notification_web-9e1124ac683eb295ff71adea39052c50.png"},28453(e,t,n){n.d(t,{R:()=>s,x:()=>o});var i=n(296540);let r={},d=i.createContext(r);function s(e){let t=i.useContext(d);return i.useMemo(function(){return"function"==typeof e?e(t):{...t,...e}},[t,e])}function o(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:s(e.components),i.createElement(d.Provider,{value:t},e.children)}},853748(e){e.exports=JSON.parse('{"id":"external/react-native-theoplayer/doc/background","title":"Background Playback and Notifications","description":"Overview","source":"@site/theoplayer/external/react-native-theoplayer/doc/background.md","sourceDirName":"external/react-native-theoplayer/doc","slug":"/getting-started/frameworks/react-native/background","permalink":"/documentation/pr-preview/pr-515/theoplayer/getting-started/frameworks/react-native/background","draft":false,"unlisted":false,"editUrl":"https://github.com/THEOplayer/react-native-theoplayer/blob/-/doc/background.md","tags":[],"version":"current","frontMatter":{"slug":"/getting-started/frameworks/react-native/background"},"sidebar":"react-native","previous":{"title":"Audio Control Management on Android","permalink":"/documentation/pr-preview/pr-515/theoplayer/getting-started/frameworks/react-native/audio-control"},"next":{"title":"Casting with Chromecast and Airplay","permalink":"/documentation/pr-preview/pr-515/theoplayer/getting-started/frameworks/react-native/cast"}}')}}]);