"use strict";(self.webpackChunkdocumentation=self.webpackChunkdocumentation||[]).push([["18714"],{823116(e,n,t){t.r(n),t.d(n,{assets:()=>l,contentTitle:()=>r,default:()=>p,frontMatter:()=>o,metadata:()=>a,toc:()=>c});var a=t(977675),i=t(474848),s=t(28453);let o={title:"Datadog",slug:"/playback/client-analytics/datadog"},r,l={},c=[{value:"Client Analytics",id:"client-analytics",level:2},{value:"Setting Up Datadog Browser Agent",id:"setting-up-datadog-browser-agent",level:2},{value:"1. Initialize the Datadog Browser Agent",id:"1-initialize-the-datadog-browser-agent",level:3},{value:"2. Capture Millicast Track Events",id:"2-capture-millicast-track-events",level:3},{value:"3. Collect WebRTC Stats",id:"3-collect-webrtc-stats",level:3},{value:"4. Setup a Datadog Dashboard",id:"4-setup-a-datadog-dashboard",level:3},{value:"Sample",id:"sample",level:2}];function d(e){let n={a:"a",code:"code",h2:"h2",h3:"h3",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,s.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Datadog"})," is a tool for monitoring application performance measurements and user engagement."]}),"\n",(0,i.jsxs)(n.p,{children:["This page guides you on some of the metrics that are collected and setps to integrate the ",(0,i.jsx)(n.a,{href:"/documentation/pr-preview/pr-507/millicast/playback/players-sdks/web/sdk/",children:"Millicast SDK"})," to the browser agent."]}),"\n",(0,i.jsx)(n.h2,{id:"client-analytics",children:"Client Analytics"}),"\n",(0,i.jsxs)(n.p,{children:["To monitor the health of your application, ",(0,i.jsx)(n.a,{href:"/documentation/pr-preview/pr-507/millicast/playback/client-analytics",children:"client analytics"})," for monitoring and troubleshooting are critical. You can customize Datadog with dashboards to display collected data such as:"]}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Device analytics such as user agent, browser, operating system, device size, versions"}),"\n",(0,i.jsx)(n.li,{children:"Geolocation details including country, city, ip address and network details"}),"\n",(0,i.jsx)(n.li,{children:"WebRTC statistics like fps, round trip time, jitter, packet and frame loss rates, and bitrate"}),"\n"]}),"\n",(0,i.jsxs)(n.p,{children:["When combined with our ",(0,i.jsx)(n.a,{href:"/documentation/pr-preview/pr-507/millicast/live-monitoring",children:"Live Monitoring"})," and ",(0,i.jsx)(n.a,{href:"/millicast/distribution/syndication",children:"Stream Syndication"})," capabilities you can effectively monitor playback issues and track viewer characteristics."]}),"\n",(0,i.jsx)(n.h2,{id:"setting-up-datadog-browser-agent",children:"Setting Up Datadog Browser Agent"}),"\n",(0,i.jsx)(n.h3,{id:"1-initialize-the-datadog-browser-agent",children:"1. Initialize the Datadog Browser Agent"}),"\n",(0,i.jsx)(n.p,{children:"Include the browser agent:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-html",children:'<script type="text/javascript" src="https://www.datadoghq-browser-agent.com/us1/v5/datadog-logs.js"><\/script>\n'})}),"\n",(0,i.jsxs)(n.p,{children:["Early in your application you will need to initialize the agent with details from your Datadog account. You'll need your ",(0,i.jsx)(n.strong,{children:"clientToken"})," and ",(0,i.jsx)(n.strong,{children:"site"}),"."]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-javascript",children:"window.DD_LOGS &&\n  window.DD_LOGS.init({\n    clientToken: 'pub922...187',\n    site: 'datadoghq.eu',\n    forwardErrorsToLogs: true,\n    sessionSampleRate: 100,\n  });\n"})}),"\n",(0,i.jsx)(n.h3,{id:"2-capture-millicast-track-events",children:"2. Capture Millicast Track Events"}),"\n",(0,i.jsx)(n.p,{children:"When receiving a track event after connecting, you can send the event."}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-javascript",children:"millicastView.on('track', (event) => {\n  // ...\n  window.DD_LOGS.logger.info(event);\n});\n"})}),"\n",(0,i.jsxs)(n.p,{children:["You may also want to capture ",(0,i.jsx)(n.a,{href:"/documentation/pr-preview/pr-507/millicast/playback/players-sdks/viewer-events",children:"Broadcast Events"})," for a fuller picture."]}),"\n",(0,i.jsx)(n.h3,{id:"3-collect-webrtc-stats",children:"3. Collect WebRTC Stats"}),"\n",(0,i.jsxs)(n.p,{children:["See the ",(0,i.jsx)(n.a,{href:"/documentation/pr-preview/pr-507/millicast/playback/client-analytics",children:"Client Analytics"})," guide to learn more about what media statistics and metrics are captured for the WebRTC connection."]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-javascript",children:"millicastView.webRTCPeer.on('stats', (stats) => {\n  window.DD_LOGS.logger.info(stats);\n});\n"})}),"\n",(0,i.jsx)(n.h3,{id:"4-setup-a-datadog-dashboard",children:"4. Setup a Datadog Dashboard"}),"\n",(0,i.jsx)(n.p,{children:"As the events are logged in Datadog, you can create a custom Dashboard to display the metrics that are of most interest to you."}),"\n",(0,i.jsx)(n.h2,{id:"sample",children:"Sample"}),"\n",(0,i.jsx)(n.p,{children:"Here is an example payload from the Datadog agent:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-json",children:'{\n  "id": "AgA...j",\n  "content": {\n    "timestamp": "2024-04-03T18:30:16.236Z",\n    "tags": ["sdk_version:5.14.0", "source:browser", "api:fetch", "datadog.submission_auth:client_token"],\n    "attributes": {\n      "date": 1712169016236,\n      "candidateType": "prflx",\n      "origin": "logger",\n      "session_id": "c98...1",\n      "raw": "[RTCStatsReport]",\n      "video": {\n        "inbounds": [\n          {\n            "frameHeight": 1080,\n            "totalBytesReceived": 389271613,\n            "packetsLostDeltaPerSecond": 0,\n            "mid": "0",\n            "totalPacketsReceived": 342289,\n            "bitrate": 3004616,\n            "mimeType": "video/H264",\n            "trackIdentifier": "ad5...6",\n            "frameWidth": 1920,\n            "jitter": 0.001,\n            "packetsLostRatioPerSecond": 0,\n            "totalPacketsLost": 0,\n            "framesPerSecond": 24,\n            "id": "IT0...0",\n            "timestamp": 1712169016229.288\n          }\n        ]\n      },\n      "availableOutgoingBitrate": 300000,\n      "network": {\n        "client": {\n          "geoip": {\n            "continent": {\n              "code": "EU",\n              "name": "Europe"\n            },\n            "country": {\n              "name": "United Kingdom",\n              "iso_code": "GB"\n            },\n            "subdivision": {\n              "name": "England",\n              "iso_code": "GB-ENG"\n            },\n            "as": {\n              "number": "AS13237",\n              "route": "127.n.n.0/16",\n              "domain": "eunetworks.com",\n              "name": "euNetworks GmbH",\n              "type": "hosting"\n            },\n            "city": {\n              "name": "London"\n            },\n            "timezone": "Europe/London",\n            "ipAddress": "127.n.n.0",\n            "location": {\n              "latitude": 0.0,\n              "longitude": 0.0\n            }\n          },\n          "ip": "127.n.n.0"\n        }\n      },\n      "view": {\n        "referrer": "http://127.0.0.1:8000/demo/index.html",\n        "url_details": {\n          "path": "/demo/index.html",\n          "scheme": "http",\n          "port": 5500,\n          "host": "127.0.0.1"\n        },\n        "referrer_details": {\n          "path": "/demo/index.html",\n          "scheme": "http",\n          "port": 5500,\n          "host": "127.0.0.1"\n        },\n        "url": "http://127.0.0.1:5500/demo/index.html"\n      },\n      "totalRoundTripTime": 11.284,\n      "http": {\n        "useragent": "Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/123.0.0.0 Safari/537.36",\n        "useragent_details": {\n          "os": {\n            "patch": "7",\n            "major": "10",\n            "minor": "15",\n            "family": "Mac OS X"\n          },\n          "browser": {\n            "patch": "0",\n            "patch_minor": "0",\n            "major": "123",\n            "minor": "0",\n            "family": "Chrome"\n          },\n          "device": {\n            "model": "Mac",\n            "family": "Mac",\n            "category": "Desktop",\n            "brand": "Apple"\n          }\n        }\n      },\n      "audio": {\n        "inbounds": [\n          {\n            "jitter": 0.002,\n            "totalBytesReceived": 12901210,\n            "packetsLostRatioPerSecond": 0,\n            "packetsLostDeltaPerSecond": 0,\n            "totalPacketsLost": 0,\n            "mid": "1",\n            "totalPacketsReceived": 51984,\n            "bitrate": 96272,\n            "mimeType": "audio/opus",\n            "id": "IT0...3",\n            "trackIdentifier": "3e5...4",\n            "timestamp": 1712169016229.288\n          }\n        ]\n      },\n      "currentRoundTripTime": 0.006,\n      "status": "info"\n    }\n  }\n}\n'})})]})}function p(e={}){let{wrapper:n}={...(0,s.R)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(d,{...e})}):d(e)}},28453(e,n,t){t.d(n,{R:()=>o,x:()=>r});var a=t(296540);let i={},s=a.createContext(i);function o(e){let n=a.useContext(s);return a.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function r(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:o(e.components),a.createElement(s.Provider,{value:n},e.children)}},977675(e){e.exports=JSON.parse('{"id":"playback/client-analytics/datadog","title":"Datadog","description":"Datadog is a tool for monitoring application performance measurements and user engagement.","source":"@site/millicast/playback/client-analytics/datadog.mdx","sourceDirName":"playback/client-analytics","slug":"/playback/client-analytics/datadog","permalink":"/documentation/pr-preview/pr-507/millicast/playback/client-analytics/datadog","draft":false,"unlisted":false,"editUrl":"https://github.com/THEOplayer/documentation/blob/-/millicast/playback/client-analytics/datadog.mdx","tags":[],"version":"current","frontMatter":{"title":"Datadog","slug":"/playback/client-analytics/datadog"},"sidebar":"millicast","previous":{"title":"Client Analytics","permalink":"/documentation/pr-preview/pr-507/millicast/playback/client-analytics"},"next":{"title":"Datazoom","permalink":"/documentation/pr-preview/pr-507/millicast/playback/client-analytics/datazoom"}}')}}]);