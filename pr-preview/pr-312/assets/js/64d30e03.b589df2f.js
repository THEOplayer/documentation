"use strict";(self.webpackChunkdocumentation=self.webpackChunkdocumentation||[]).push([["2486"],{6209:function(e,n,t){t.r(n),t.d(n,{default:()=>p,frontMatter:()=>a,metadata:()=>s,assets:()=>d,toc:()=>l,contentTitle:()=>o});var s=JSON.parse('{"id":"getting-started/sdks/roku/displaying-ads","title":"Playing ads with THEOplayer Roku SDK","description":"This article will provide the steps needed to play video ads with your content using the THEOplayer Roku SDK.","source":"@site/theoplayer/getting-started/01-sdks/09-roku/02-displaying-ads.md","sourceDirName":"getting-started/01-sdks/09-roku","slug":"/getting-started/sdks/roku/displaying-ads","permalink":"/documentation/pr-preview/pr-312/theoplayer/getting-started/sdks/roku/displaying-ads","draft":false,"unlisted":false,"editUrl":"https://github.com/THEOplayer/documentation/blob/-/theoplayer/getting-started/01-sdks/09-roku/02-displaying-ads.md","tags":[],"version":"current","sidebarPosition":2,"frontMatter":{},"sidebar":"roku","previous":{"title":"Migrating to THEOplayer Roku SDK 9.x","permalink":"/documentation/pr-preview/pr-312/theoplayer/getting-started/sdks/roku/migrating-to-theoplayer-9"},"next":{"title":"How-to guides","permalink":"/documentation/pr-preview/pr-312/theoplayer/how-to-guides/"}}'),r=t("85893"),i=t("50065");let a={},o="Playing ads with THEOplayer Roku SDK",d={},l=[{value:"First Steps",id:"first-steps",level:2},{value:"Clientside Ad Insertion",id:"clientside-ad-insertion",level:2},{value:"Create your ad descriptions",id:"create-your-ad-descriptions",level:3},{value:"Mixing VAST and VMAP Ads",id:"mixing-vast-and-vmap-ads",level:4},{value:"Listen for ad events",id:"listen-for-ad-events",level:3},{value:"Monitoring RAF",id:"monitoring-raf",level:3},{value:"Limitations",id:"limitations",level:3}];function c(e){let n={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",h4:"h4",header:"header",li:"li",p:"p",pre:"pre",ul:"ul",...(0,i.a)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.header,{children:(0,r.jsx)(n.h1,{id:"playing-ads-with-theoplayer-roku-sdk",children:"Playing ads with THEOplayer Roku SDK"})}),"\n",(0,r.jsx)(n.p,{children:"This article will provide the steps needed to play video ads with your content using the THEOplayer Roku SDK."}),"\n",(0,r.jsx)(n.h2,{id:"first-steps",children:"First Steps"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Make sure you are using a version of the SDK that supports ads. CSAI is available for VOD content in v9.3 and higher of the SDK."}),"\n",(0,r.jsxs)(n.li,{children:["Include the RAF advertising library in your application's manifest file by adding this line:\n",(0,r.jsx)(n.code,{children:"bs_libs_required=roku_ads_lib"})]}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"clientside-ad-insertion",children:"Clientside Ad Insertion"}),"\n",(0,r.jsxs)(n.p,{children:["The THEOplayer Roku SDK currently only supports Clientside Ad Insertion (CSAI) for VOD assets. It does not yet support Clientside Ad Stitching (CSAS), Serverside Ad Insertion (SSAI), Server Guided Ad Insertion (SGAI) or live ads. It supports CSAI by using the Roku Advertising Framework (RAF), which is provided by Roku. It supports VMAP and VAST ad tags. For more information about specific features of VAST or VMAP supported by RAF, please visit their ",(0,r.jsx)(n.a,{href:"https://developer.roku.com/docs/developer-program/advertising/roku-advertising-framework.md",children:"support page"}),"."]}),"\n",(0,r.jsx)(n.h3,{id:"create-your-ad-descriptions",children:"Create your ad descriptions"}),"\n",(0,r.jsxs)(n.p,{children:["Ads are added to your content by adding ad sources to your source descriptions that are set on the ",(0,r.jsx)(n.code,{children:"source"})," property of the THEOplayer. Here is an example for VAST ad tags:"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-brightscript",children:'m.player.source = {\n    "title": "My VOD Asset",\n    "live": false,\n    "sources": {\n        "src": "https://example.com/my_vod_asset.m3u8",\n        "type": "application/x-mpegurl"\n    },\n    "ads": [\n        {\n            integration: "csai",\n            sources: "https://exampleadserver.com/preroll.xml",\n            timeOffset: "start"\n        },\n        {\n            integration: "csai",\n            sources: "https://exampleadserver.com/midroll.xml",\n            timeOffset: 30\n        },\n        {\n            integration: "csai",\n            sources: "https://exampleadserver.com/midroll2.xml",\n            timeOffset: 190\n        },\n        {\n            integration: "csai",\n            sources: "https://exampleadserver.com/postroll.xml",\n            timeOffset: "end"\n        }\n    ]\n}\n'})}),"\n",(0,r.jsx)(n.p,{children:"For VMAP ads, the timing is contained within the VMAP file itself, so the configuration is simpler:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-brightscript",children:'m.player.source = {\n    "title": "My VOD Asset",\n    "live": false,\n    "sources": {\n        "src": "https://example.com/my_vod_asset.m3u8",\n        "type": "application/x-mpegurl"\n    },\n    "ads": [\n        {\n            integration: "csai",\n            sources: "https://exampleadserver.com/vmap.xml",\n        }\n    ]\n}\n'})}),"\n",(0,r.jsxs)(n.p,{children:["Note that the ",(0,r.jsx)(n.code,{children:"timeOffset"})," property must be omitted for VMAP ads."]}),"\n",(0,r.jsxs)(n.p,{children:["You may also specify the timings for VAST ads either by using a timecode or by specifying the percent of the asset that should play before displaying the ad. Timecodes should be in the format ",(0,r.jsx)(n.code,{children:"HH:MM:SS"}),"."]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-brightscript",children:'m.player.source = {\n    "title": "My VOD Asset",\n    "live": false,\n    "sources": {\n        "src": "https://example.com/my_vod_asset.m3u8",\n        "type": "application/x-mpegurl"\n    },\n    "ads": [\n        {\n            integration: "csai",\n            sources: "https://exampleadserver.com/midroll.xml",\n            timeOffset: "00:05:30"\n        },\n        {\n            integration: "csai",\n            sources: "https://exampleadserver.com/midroll2.xml",\n            timeOffset: "25%"\n        }\n    ]\n}\n'})}),"\n",(0,r.jsx)(n.h4,{id:"mixing-vast-and-vmap-ads",children:"Mixing VAST and VMAP Ads"}),"\n",(0,r.jsx)(n.p,{children:"Currently, this is not supported. Support may be added for this in the future."}),"\n",(0,r.jsx)(n.h3,{id:"listen-for-ad-events",children:"Listen for ad events"}),"\n",(0,r.jsxs)(n.p,{children:["To detect events emitted for the ads, you can call the ",(0,r.jsx)(n.code,{children:"addEventListener"})," method on the Ads API. You can see the list of ad events on ",(0,r.jsx)(n.a,{href:"/documentation/pr-preview/pr-312/theoplayer/api-reference/roku#ads-api",children:"the API reference page"}),". Note that the method used for the listener needs to be exposed through the interface of the node that owns the listener function."]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-brightscript",children:'adEvents = m.player.ads.events\nm.player.ads.callFunc("addEventListener", adEvents.adbreakbegin, m.top, "onAdBreakBegin")\nm.player.ads.callFunc("addEventListener", adEvents.adbreakend, m.top, "onAdBreakEnd")\n'})}),"\n",(0,r.jsxs)(n.p,{children:["To clean up, you can simply call ",(0,r.jsx)(n.code,{children:"removeEventListener"})," the same way."]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-brightscript",children:'m.player.ads.callFunc("removeEventListener", adEvents.adbreakbegin, m.top, "onAdBreakBegin")\nm.player.ads.callFunc("removeEventListener", adEvents.adbreakend, m.top, "onAdBreakEnd")\n'})}),"\n",(0,r.jsxs)(n.p,{children:["Also, if you just want to see whether ads are playing or not, observe the ",(0,r.jsx)(n.code,{children:"playing"})," field on the Ads API. You can see the other fields available on ",(0,r.jsx)(n.a,{href:"/documentation/pr-preview/pr-312/theoplayer/api-reference/roku#ads-api",children:"the API reference page"}),"."]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-brightscript",children:'m.player.ads.observeField("playing", "onAdsPlayingChange")\n\nsub onAdsPlayingChange( event as object )\n    adsPlaying = event.getData()\nend sub\n'})}),"\n",(0,r.jsx)(n.h3,{id:"monitoring-raf",children:"Monitoring RAF"}),"\n",(0,r.jsxs)(n.p,{children:["The THEOplayer Roku SDK does not expose RAF directly. However, you can still get the data from RAF's callbacks for tracking, buffering, and library version. On the Ads API, there is the ",(0,r.jsx)(n.code,{children:"rafProxy"})," node. This field exposes data from RAF on fields of its own. To substitute for the output from RAF's ",(0,r.jsx)(n.code,{children:"setTrackingCallback"})," method, you could do the following:"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-brightscript",children:'m.player.ads.rafProxy.observeField("trackingUpdate", "onRafTrackingUpdate")\n\nsub onRafTrackingUpdate(event as object)\n    update = event.getData()\n    m.myRafObserver.rafTrackingCallback(m.myRafObserver, update.eventType, update.ctx)\nend sub\n'})}),"\n",(0,r.jsxs)(n.p,{children:["Similarly, you can listen for RAF's ",(0,r.jsx)(n.code,{children:"setAdBufferRenderCallback"})," output by observing the ",(0,r.jsx)(n.code,{children:"bufferRenderUpdate"})," field on the Ads API."]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-brightscript",children:'m.player.ads.rafProxy.observeField("bufferRenderUpdate", "onRafBufferUpdate")\n\nsub onRafBufferUpdate(event as object)\n    update = event.getData()\n    m.myRafObserver.rafBufferingCallback(m.myRafObserver, update.eventType, update.ctx)\nend sub\n'})}),"\n",(0,r.jsxs)(n.p,{children:["The ",(0,r.jsx)(n.code,{children:"rafProxy"})," field also exposes the library version of RAF via its own ",(0,r.jsx)(n.code,{children:"libVersion"})," field."]}),"\n",(0,r.jsx)(n.h3,{id:"limitations",children:"Limitations"}),"\n",(0,r.jsx)(n.p,{children:"Currently the Ads API does not support:"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Mixing and matching VAST and VMAP tags."}),"\n",(0,r.jsx)(n.li,{children:"Adding ads during playback of the asset."}),"\n",(0,r.jsx)(n.li,{children:"Reporting the exact media file that is being played for a creative."}),"\n"]})]})}function p(e={}){let{wrapper:n}={...(0,i.a)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(c,{...e})}):c(e)}},50065:function(e,n,t){t.d(n,{Z:function(){return o},a:function(){return a}});var s=t(67294);let r={},i=s.createContext(r);function a(e){let n=s.useContext(i);return s.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function o(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:a(e.components),s.createElement(i.Provider,{value:n},e.children)}}}]);