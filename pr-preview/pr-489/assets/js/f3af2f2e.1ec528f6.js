"use strict";(self.webpackChunkdocumentation=self.webpackChunkdocumentation||[]).push([["51297"],{565980(e,t,s){s.r(t),s.d(t,{assets:()=>l,contentTitle:()=>a,default:()=>u,frontMatter:()=>i,metadata:()=>n,toc:()=>p});var n=s(351715),r=s(474848),o=s(28453);let i={},a="iOS HLS Media Playlist Interceptor",l={},p=[{value:"Set up THEOplayer",id:"set-up-theoplayer",level:2},{value:"Intercepting the requests and/or responses",id:"intercepting-the-requests-andor-responses",level:2},{value:"DRM request interception",id:"drm-request-interception",level:2}];function d(e){let t={a:"a",code:"code",h1:"h1",h2:"h2",header:"header",p:"p",pre:"pre",...(0,o.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(t.header,{children:(0,r.jsx)(t.h1,{id:"ios-hls-media-playlist-interceptor",children:"iOS HLS Media Playlist Interceptor"})}),"\n",(0,r.jsx)(t.p,{children:"THEOplayer iOS SDK makes a number of network requests and receives responses while playing video. These requests and responses can be intercepted to make a new or modified request, or respond with a new response to the HLS playlist requests."}),"\n",(0,r.jsx)(t.p,{children:"This guide explains how you set up THEOplayer iOS SDK to add and remove request/response interceptors."}),"\n",(0,r.jsx)(t.p,{children:"We will use a simple UIKit UIViewController for this guide."}),"\n",(0,r.jsx)(t.h2,{id:"set-up-theoplayer",children:"Set up THEOplayer"}),"\n",(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{className:"language-swift",children:"class ViewController: UIViewController {\n    private var player: THEOplayer?\n\n    override func viewDidLoad() {\n        super.viewDidLoad()\n        let player = THEOplayer()\n        self.player = player\n        player.frame = view.bounds\n        player.addAsSubview(of: self.view)\n        player.network.addMediaPlaylistInterceptor(self)\n    }\n}\n"})}),"\n",(0,r.jsx)(t.h2,{id:"intercepting-the-requests-andor-responses",children:"Intercepting the requests and/or responses"}),"\n",(0,r.jsxs)(t.p,{children:["Use the ",(0,r.jsx)(t.code,{children:"type"})," parameter on each method below to filter for HLS playlist types ie. master, video, subtitles, etc...\nThe rest of the usage is explained in comments in the code snippet below."]}),"\n",(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{className:"language-swift",children:'extension ViewController: MediaPlaylistInterceptor {\n    // For modifications that you would make to the request, ie. add custom headers, query parameters, etc...\n    func shouldInterceptPlaylistRequest(type: THEOplayerSDK.HlsPlaylistType) -> Bool { true }\n\n    // For modifications that you would make to the response, ie. edit the m3u8 file content, vtt file content etc...\n    func shouldInterceptPlaylistResponse(type: THEOplayerSDK.HlsPlaylistType) -> Bool { true }\n\n    // Will be called if shouldInterceptPlaylistRequest returns true\n    func didInterceptPlaylistRequest(type: THEOplayerSDK.HlsPlaylistType, request: URLRequest) async throws -> URLRequest {\n        var modifiedRequest = request\n        // modify\n        // ...\n        //...\n        return modifiedRequest\n    }\n\n    // Will be called if shouldInterceptPlaylistResponse returns true\n    func didInterceptPlaylistResponse(type: THEOplayerSDK.HlsPlaylistType, url: URL, response: URLResponse, data: Data) async throws -> Data {\n        var modifiedResponseData = ""\n        // customize the data string that you would like to return, should be a valid HLS playlist file\n        // ...\n        // ...\n        let customDataResponse = modifiedResponseData.data(using: .utf8)\n        return customDataResponse ?? data // `customDataResponse` is empty so playback will fail in this demo; return `data` to play\n    }\n\n    // Handle failure.\n    func failedToPerformURLRequest(request: URLRequest, response: URLResponse) {}\n}\n'})}),"\n",(0,r.jsx)(t.h2,{id:"drm-request-interception",children:"DRM request interception"}),"\n",(0,r.jsxs)(t.p,{children:["The ",(0,r.jsx)(t.code,{children:"MediaPlaylistInterceptor"})," API does not intercept DRM requests. To interecept fairplay DRM requests, take a look at the following solution: ",(0,r.jsx)(t.a,{href:"https://github.com/THEOplayer/samples-drm-integration/blob/master/ios/README.md",children:"https://github.com/THEOplayer/samples-drm-integration/blob/master/ios/README.md"})]})]})}function u(e={}){let{wrapper:t}={...(0,o.R)(),...e.components};return t?(0,r.jsx)(t,{...e,children:(0,r.jsx)(d,{...e})}):d(e)}},28453(e,t,s){s.d(t,{R:()=>i,x:()=>a});var n=s(296540);let r={},o=n.createContext(r);function i(e){let t=n.useContext(o);return n.useMemo(function(){return"function"==typeof e?e(t):{...t,...e}},[t,e])}function a(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:i(e.components),n.createElement(o.Provider,{value:t},e.children)}},351715(e){e.exports=JSON.parse('{"id":"how-to-guides/network/ios-hls-media-playlist-interceptor","title":"iOS HLS Media Playlist Interceptor","description":"THEOplayer iOS SDK makes a number of network requests and receives responses while playing video. These requests and responses can be intercepted to make a new or modified request, or respond with a new response to the HLS playlist requests.","source":"@site/theoplayer/how-to-guides/08-network/03-ios-hls-media-playlist-interceptor.md","sourceDirName":"how-to-guides/08-network","slug":"/how-to-guides/network/ios-hls-media-playlist-interceptor","permalink":"/documentation/pr-preview/pr-489/theoplayer/how-to-guides/network/ios-hls-media-playlist-interceptor","draft":false,"unlisted":false,"editUrl":"https://github.com/THEOplayer/documentation/blob/-/theoplayer/how-to-guides/08-network/03-ios-hls-media-playlist-interceptor.md","tags":[],"version":"current","sidebarPosition":3,"frontMatter":{},"sidebar":"roku","previous":{"title":"Android Network Request/Response Interceptor","permalink":"/documentation/pr-preview/pr-489/theoplayer/how-to-guides/network/android-network-interceptor"},"next":{"title":"Introduction","permalink":"/documentation/pr-preview/pr-489/theoplayer/how-to-guides/player/introduction"}}')}}]);